<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../dist/output.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <title>J's Portfolio</title>
    <link rel="icon" type="image/png" href="../assets/images/icon.png"/>
</head>

<body class="bg-tetriary font-sans">
    <!-- Navbar -->
    <nav class="bg-primary w-10/12 mx-auto mt-8 py-4 px-4 rounded-3xl flex justify-center items-center">
        <a href="../index.html">
            <svg width="25" height="37" viewBox="0 0 25 37" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0.04 36.52V35.68C1.05333 35.5733 1.92 35.2667 2.64 34.76C3.38667 34.2533 3.96 33.3733 4.36 32.12C4.76 30.8667 4.96 29.1067 4.96 26.84V4.92C4.96 3.93333 4.88 3.21333 4.72 2.76C4.58667 2.28 4.30667 1.96 3.88 1.8C3.45333 1.61333 2.84 1.50667 2.04 1.48V0.68C2.70667 0.706666 3.61333 0.733332 4.76 0.759999C5.90667 0.786665 7.10667 0.799998 8.36 0.799998C9.64 0.799998 10.88 0.786665 12.08 0.759999C13.3067 0.733332 14.32 0.706666 15.12 0.68V1.48C14.2933 1.50667 13.6667 1.61333 13.24 1.8C12.8133 1.96 12.5333 2.28 12.4 2.76C12.2667 3.21333 12.2 3.93333 12.2 4.92V19.56C12.2 20.6533 12.2 21.84 12.2 23.12C12.2 24.3733 12.1467 25.6 12.04 26.8C11.96 28 11.7867 29.0667 11.52 30C10.96 31.84 9.73333 33.3867 7.84 34.64C5.94667 35.8933 3.34667 36.52 0.04 36.52ZM21.1684 23.04C22.3151 23.04 23.2084 23.32 23.8484 23.88C24.5151 24.44 24.8484 25.24 24.8484 26.28C24.8484 27.3467 24.5151 28.16 23.8484 28.72C23.2084 29.28 22.3151 29.56 21.1684 29.56C19.9951 29.56 19.0884 29.28 18.4484 28.72C17.8084 28.16 17.4884 27.3467 17.4884 26.28C17.4884 25.24 17.8084 24.44 18.4484 23.88C19.0884 23.32 19.9951 23.04 21.1684 23.04Z" fill="black"/>
            </svg>
        </a>
    </nav>

    <main class="w-10/12 mx-auto mt-10 mb-10">
        <!-- Title and Filter-->
        <section class="flex justify-between">
            <!-- Title and description -->
            <section>
                <h3 class="text-black font-bold text-4xl">My Projects</h3>
                <p class="text-gray-200 text-lg mt-2 italic">View all my projects from Year 1 to Year 2</p>
            </section>

            <!-- Filter -->
            <section>
                <button id="filterToggle" class="bg-primary text-white px-4 py-2 rounded-xl flex">                      
                    Filter
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" />
                    </svg>
                </button>
            
                <div id="filterDropdown" class="absolute right-0 mt-2 w-52 bg-white border border-gray-300 rounded-lg shadow-lg p-4 hidden space-y-2">
                <!-- Tags will be injected here -->
                </div>
            </section>
        </section>

        <!-- Cards section -->
        <section id="projects-container" class="mx-auto max-h-min mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-10 text-black items-stretch">
            <!-- Projects will be dynamically inserted here -->
        </section>
    </main>
</body>

<!-- Footer -->
<footer class="w-10/12 mx-auto my-20 bg-tertiary flex justify-end">
    <svg width="35" height="50" viewBox="0 0 25 37" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M0.04 36.52V35.68C1.05333 35.5733 1.92 35.2667 2.64 34.76C3.38667 34.2533 3.96 33.3733 4.36 32.12C4.76 30.8667 4.96 29.1067 4.96 26.84V4.92C4.96 3.93333 4.88 3.21333 4.72 2.76C4.58667 2.28 4.30667 1.96 3.88 1.8C3.45333 1.61333 2.84 1.50667 2.04 1.48V0.68C2.70667 0.706666 3.61333 0.733332 4.76 0.759999C5.90667 0.786665 7.10667 0.799998 8.36 0.799998C9.64 0.799998 10.88 0.786665 12.08 0.759999C13.3067 0.733332 14.32 0.706666 15.12 0.68V1.48C14.2933 1.50667 13.6667 1.61333 13.24 1.8C12.8133 1.96 12.5333 2.28 12.4 2.76C12.2667 3.21333 12.2 3.93333 12.2 4.92V19.56C12.2 20.6533 12.2 21.84 12.2 23.12C12.2 24.3733 12.1467 25.6 12.04 26.8C11.96 28 11.7867 29.0667 11.52 30C10.96 31.84 9.73333 33.3867 7.84 34.64C5.94667 35.8933 3.34667 36.52 0.04 36.52ZM21.1684 23.04C22.3151 23.04 23.2084 23.32 23.8484 23.88C24.5151 24.44 24.8484 25.24 24.8484 26.28C24.8484 27.3467 24.5151 28.16 23.8484 28.72C23.2084 29.28 22.3151 29.56 21.1684 29.56C19.9951 29.56 19.0884 29.28 18.4484 28.72C17.8084 28.16 17.4884 27.3467 17.4884 26.28C17.4884 25.24 17.8084 24.44 18.4484 23.88C19.0884 23.32 19.9951 23.04 21.1684 23.04Z" fill="black"/>
    </svg>
</footer>

<!-- Script -->
<script>
    // Get elements
    const dropdown = document.getElementById('filterDropdown');
    const filterToggle = document.getElementById('filterToggle');
    const projectsContainer = document.getElementById('projects-container');

    // Toggle the visibility of the dropdown when the button is clicked
    filterToggle.addEventListener('click', () => {
        dropdown.classList.toggle('hidden');
    });

    // Close the dropdown when the mouse leaves the dropdown area
    dropdown.addEventListener('mouseleave', () => {
        dropdown.classList.add('hidden');
    });

    // Show the dropdown when the mouse hovers over the button or dropdown area
    filterToggle.addEventListener('mouseenter', () => {
        dropdown.classList.remove('hidden');
    });

    filterToggle.addEventListener('mouseleave', () => {
        dropdown.classList.add('hidden');
    });

    dropdown.addEventListener('mouseenter', () => {
        dropdown.classList.remove('hidden');
    });

    // Load JSON data
    fetch('../assets/data/projects.json')
    .then(res => res.json())
    .then(projects => {
        const allTags = [...new Set(projects.flatMap(p => p.tags))];

        // Create tag checkboxes for filtering
        allTags.forEach(tag => {
        const label = document.createElement('label');
        label.className = "flex items-center gap-2 cursor-pointer rounded-lg";
        label.innerHTML = `
            <input type="checkbox" value="${tag}" class="tag-filter accent-primary">
            ${tag}
        `;
        dropdown.appendChild(label);
        });

        // Toggle Dropdown visibility
        filterToggle.addEventListener('click', () => {
        dropdown.classList.toggle('hidden');
        });

        // Filter projects based on selected tags
        const filterProjects = () => {
        const checkedTags = [...document.querySelectorAll('.tag-filter:checked')].map(input => input.value);
        const filteredProjects = projects.filter(project =>
            checkedTags.length === 0 || project.tags.some(tag => checkedTags.includes(tag))
        );
        displayProjects(filteredProjects);
        };

        // Listen to changes on tag checkboxes
        document.addEventListener('change', (e) => {
        if (!e.target.classList.contains('tag-filter')) return;
        filterProjects();
        });

        // Display all projects by default
        displayProjects(projects);
    });

    // Function to render the projects as cards
    function displayProjects(projects) {
    projectsContainer.innerHTML = ''; // Clear previous cards

    projects.forEach(project => {
        const card = document.createElement('div');
        card.className = "p-6 bg-white rounded-xl shadow hover:scale-105 transition duration-300";

        card.innerHTML = `
                    <article class="bg-white rounded-2xl p-4 h-full w-full shadow-md">
                        <!-- Image -->
                        <section class="w-full h-[50vh] flex items-center justify-center overflow-hidden rounded-xl">
                            <img src="${project.images[0]}" alt="${project.projectName}" class="w-full h-full object-cover">
                        </section>
    
                        <!-- Tags -->
                        <section class="flex space-x-2 items-center mt-4 text-sm md:text-md">
                            ${project.tags.map(tag => `
                                <article class="bg-secondary text-white px-4 py-1 rounded-3xl items-center">
                                    <p class="text-black font-bold">${tag}</p>
                                </article>
                            `).join('')}
                        </section>
    
                        <!-- Project information -->
                        <section>
                            <p class="text-2xl mt-3 font-bold break-words">${project.projectName}</p>
                            <p class="mt-2 break-words">${project.projectDescription}</p>
                        </section>
                        
                        <section class="mt-2">
                            <p class="break-words"><strong>Tech Stack:</strong>
                                ${project.techStack.map((tech, index) => `
                                    <span>${tech}${index < project.techStack.length - 1 ? ',' : ''}</span>
                                `).join('')}
                            </p>
                        </section>

                        <!-- Github button (only show if repositoryUrl exists) -->
                        ${project.repositoryUrl ? `
                            <section class="mt-4 flex justify-end">
                                <a href="${project.repositoryUrl}" target="_blank" class="bg-secondary px-4 py-1 rounded-xl text-sm no-underline font-bold">
                                    View on GitHub
                                </a>
                            </section>
                        ` : ''}
                    </article>
                `;

        projectsContainer.appendChild(card);
    });
    }
</script>
</html>